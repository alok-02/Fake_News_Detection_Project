{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ImcmoKbsebd_"},"outputs":[],"source":["\n","import pandas as pd\n","\n","# # Load your dataset into a pandas DataFrame\n","train_news = pd.read_csv('/content/drive/MyDrive/Colab_Notebooks/Fake_News_Detection/train.csv')\n","test_news = pd.read_csv('/content/drive/MyDrive/Colab_Notebooks/Fake_News_Detection/test.csv')\n","valid_news = pd.read_csv('/content/drive/MyDrive/Colab_Notebooks/Fake_News_Detection/valid.csv')\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":2584,"status":"ok","timestamp":1688952585306,"user":{"displayName":"Alok Kumar","userId":"15647139801406588119"},"user_tz":-330},"id":"JK5LIKSums5f","outputId":"877f43e3-4adb-4d09-a97f-6d6ea5459761"},"outputs":[{"name":"stdout","output_type":"stream","text":["training dataset size:\n","(10240, 2)\n","                                           Statement  Label\n","0  Says the Annies List political group supports ...  False\n","1  When did the decline of coal start? It started...   True\n","2  Hillary Clinton agrees with John McCain \"by vo...   True\n","3  Health care reform legislation is likely to ma...  False\n","4  The economic turnaround started at the end of ...   True\n","5  The Chicago Bears have had more starting quart...   True\n","6  Jim Dunnam has not lived in the district he re...  False\n","7  I'm the only person on this stage who has work...   True\n","8  However, it took $19.5 million in Oregon Lotte...   True\n","9  Says GOP primary opponents Glenn Grothman and ...   True\n","(2551, 2)\n","                                           Statement  Label\n","0  Building a wall on the U.S.-Mexico border will...   True\n","1  Wisconsin is on pace to double the number of l...  False\n","2  Says John McCain has done nothing to help the ...  False\n","3  Suzanne Bonamici supports a plan that will cut...   True\n","4  When asked by a reporter whether hes at the ce...  False\n","5  Over the past five years the federal governmen...   True\n","6  Says that Tennessee law requires that schools ...   True\n","7  Says Vice President Joe Biden \"admits that the...  False\n","8  Donald Trump is against marriage equality. He ...   True\n","9  We know that more than half of Hillary Clinton...  False\n","(2571, 2)\n","                                           Statement  Label\n","0  We have less Americans working now than in the...  FALSE\n","1  When Obama was sworn into office, he DID NOT u...  FALSE\n","2  Says Having organizations parading as being so...  FALSE\n","3     Says nearly half of Oregons children are poor.   TRUE\n","4  On attacks by Republicans that various program...   TRUE\n","5  Says when armed civilians stop mass shootings ...  FALSE\n","6  Says Tennessee is providing millions of dollar...   TRUE\n","7  The health care reform plan would set limits s...  FALSE\n","8  Says Donald Trump started his career back in 1...   TRUE\n","9  Bill White has a long history of trying to lim...   TRUE\n","Checking data qualitites...\n","<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 10240 entries, 0 to 10239\n","Data columns (total 2 columns):\n"," #   Column     Non-Null Count  Dtype \n","---  ------     --------------  ----- \n"," 0   Statement  10240 non-null  object\n"," 1   Label      10240 non-null  bool  \n","dtypes: bool(1), object(1)\n","memory usage: 90.1+ KB\n","check finished.\n","<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 2551 entries, 0 to 2550\n","Data columns (total 2 columns):\n"," #   Column     Non-Null Count  Dtype \n","---  ------     --------------  ----- \n"," 0   Statement  2551 non-null   object\n"," 1   Label      2551 non-null   bool  \n","dtypes: bool(1), object(1)\n","memory usage: 22.5+ KB\n","<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 2571 entries, 0 to 2570\n","Data columns (total 2 columns):\n"," #   Column     Non-Null Count  Dtype \n","---  ------     --------------  ----- \n"," 0   Statement  2571 non-null   object\n"," 1   Label      2569 non-null   object\n","dtypes: object(2)\n","memory usage: 40.3+ KB\n"]},{"data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAAkQAAAGzCAYAAADOnwhmAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/bCgiHAAAACXBIWXMAAA9hAAAPYQGoP6dpAAArqklEQVR4nO3df1TUdaL/8ReIjCjOkAZDJLq0VEKpJZXO6cemkWi4dytqV3PTymw1tAU2Ic4tTMvox1VTK+nHFtrqTetulnL9lSalohldTC1ZK7uw1wbcjBl/Asp8/+j4+TqLW4rCAO/n45zPOc7n/Z7PvD+dQzzPZz4zBPl8Pp8AAAAMFhzoBQAAAAQaQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMFxLoBfzf//2fcnJytGLFCh0+fFjx8fF64403dNVVV0mSfD6fpkyZoldffVU1NTW69tprNW/ePF188cXWMfbv369JkyZp2bJlCg4OVlpammbPnq3w8HBrzueff6709HRt3bpVkZGRmjRpkrKzs09rjQ0NDdq7d6+6du2qoKCgc/sfAAAANAufz6cDBw4oJiZGwcE/cw3IF0D79+/39erVy3fPPff4tmzZ4vvmm298q1at8n311VfWnKefftrncDh8S5cu9W3bts33b//2b764uDjfkSNHrDlDhw719evXz7d582bfxx9/7IuPj/eNHDnSGvd4PD6n0+kbNWqUb8eOHb7//M//9IWFhflefvnl01pnZWWlTxIbGxsbGxtbG9wqKyt/9nd9kM8XuD/u+sgjj2jjxo36+OOPTznu8/kUExOjP/3pT3r44YclSR6PR06nU4WFhRoxYoS+/PJLJSYmauvWrdZVpZUrV+qWW27R3//+d8XExGjevHn693//d7ndboWGhlqvvXTpUu3atetn1+nxeBQREaHKykrZ7fZzdPYAAKA5eb1excbGqqamRg6H4yfnBvQts/fff18pKSm68847VVxcrAsvvFAPPvigxo0bJ0nas2eP3G63kpOTrec4HA4NGDBAJSUlGjFihEpKShQREWHFkCQlJycrODhYW7Zs0W233aaSkhLdcMMNVgxJUkpKip555hn98MMPOu+88/zWVVtbq9raWuvxgQMHJEl2u50gAgCgjTmd210CelP1N998Y90PtGrVKk2YMEEPPfSQ5s+fL0lyu92SJKfT6fc8p9NpjbndbkVFRfmNh4SEqFu3bn5zTnWMk1/jZPn5+XI4HNYWGxt7Ds4WAAC0VgENooaGBvXv319PPfWUrrzySj3wwAMaN26cCgoKArks5ebmyuPxWFtlZWVA1wMAAJpXQIPoggsuUGJiot++hIQEVVRUSJKio6MlSVVVVX5zqqqqrLHo6GhVV1f7jR87dkz79+/3m3OqY5z8Giez2WzW22O8TQYAQPsX0CC69tprVV5e7rfvb3/7m3r16iVJiouLU3R0tNauXWuNe71ebdmyRS6XS5LkcrlUU1Oj0tJSa866devU0NCgAQMGWHM++ugj1dfXW3PWrFmjSy+9tNH9QwAAwDwBDaLMzExt3rxZTz31lL766istWrRIr7zyitLT0yX9eBNURkaGnnzySb3//vvavn27Ro8erZiYGN16662SfryiNHToUI0bN06ffPKJNm7cqIkTJ2rEiBGKiYmRJN11110KDQ3V2LFjtXPnTi1evFizZ89WVlZWoE4dAAC0Jqf7nUHNZdmyZb7LL7/cZ7PZfL179/a98sorfuMNDQ2+xx57zOd0On02m8130003+crLy/3mfP/9976RI0f6wsPDfXa73Xfvvff6Dhw44Ddn27Ztvuuuu85ns9l8F154oe/pp58+7TV6PB6fJJ/H42n6iQIAgBZ1Jr+/A/o9RG2F1+uVw+GQx+PhfiIAANqIM/n9zd8yAwAAxiOIAACA8QgiAABgPIIIAAAYjyACAADGI4gAAIDxCCIAAGA8gggAABgvJNALAAATVEzrE+glAK1Sz7ztgV6CJK4QAQAAEEQAAAAEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4wU0iB5//HEFBQX5bb1797bGjx49qvT0dHXv3l3h4eFKS0tTVVWV3zEqKiqUmpqqzp07KyoqSpMnT9axY8f85qxfv179+/eXzWZTfHy8CgsLW+L0AABAGxHwK0SXXXaZvvvuO2vbsGGDNZaZmally5bp7bffVnFxsfbu3avbb7/dGj9+/LhSU1NVV1enTZs2af78+SosLFReXp41Z8+ePUpNTdWgQYNUVlamjIwM3X///Vq1alWLnicAAGi9QgK+gJAQRUdHN9rv8Xj05z//WYsWLdLgwYMlSW+88YYSEhK0efNmDRw4UKtXr9YXX3yhDz74QE6nU1dccYWeeOIJ5eTk6PHHH1doaKgKCgoUFxenGTNmSJISEhK0YcMGzZo1SykpKS16rgAAoHUK+BWi3bt3KyYmRhdddJFGjRqliooKSVJpaanq6+uVnJxsze3du7d69uypkpISSVJJSYn69Okjp9NpzUlJSZHX69XOnTutOScf48ScE8c4ldraWnm9Xr8NAAC0XwENogEDBqiwsFArV67UvHnztGfPHl1//fU6cOCA3G63QkNDFRER4fccp9Mpt9stSXK73X4xdGL8xNhPzfF6vTpy5Mgp15Wfny+Hw2FtsbGx5+J0AQBAKxXQt8yGDRtm/btv374aMGCAevXqpSVLligsLCxg68rNzVVWVpb12Ov1EkUAALRjAX/L7GQRERG65JJL9NVXXyk6Olp1dXWqqanxm1NVVWXdcxQdHd3oU2cnHv/cHLvd/i+jy2azyW63+20AAKD9alVBdPDgQX399de64IILlJSUpI4dO2rt2rXWeHl5uSoqKuRyuSRJLpdL27dvV3V1tTVnzZo1stvtSkxMtOacfIwTc04cAwAAIKBB9PDDD6u4uFjffvutNm3apNtuu00dOnTQyJEj5XA4NHbsWGVlZenDDz9UaWmp7r33XrlcLg0cOFCSNGTIECUmJuruu+/Wtm3btGrVKj366KNKT0+XzWaTJI0fP17ffPONsrOztWvXLr300ktasmSJMjMzA3nqAACgFQnoPUR///vfNXLkSH3//feKjIzUddddp82bNysyMlKSNGvWLAUHBystLU21tbVKSUnRSy+9ZD2/Q4cOWr58uSZMmCCXy6UuXbpozJgxmjZtmjUnLi5ORUVFyszM1OzZs9WjRw+99tprfOQeAABYgnw+ny/Qi2jtvF6vHA6HPB4P9xMBaJKKaX0CvQSgVeqZt73Zjn0mv79b1T1EAAAAgUAQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMF5IoBeA/y9p8oJALwFolUqfGx3oJQBo57hCBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjNdqgujpp59WUFCQMjIyrH1Hjx5Venq6unfvrvDwcKWlpamqqsrveRUVFUpNTVXnzp0VFRWlyZMn69ixY35z1q9fr/79+8tmsyk+Pl6FhYUtcEYAAKCtaBVBtHXrVr388svq27ev3/7MzEwtW7ZMb7/9toqLi7V3717dfvvt1vjx48eVmpqquro6bdq0SfPnz1dhYaHy8vKsOXv27FFqaqoGDRqksrIyZWRk6P7779eqVata7PwAAEDrFvAgOnjwoEaNGqVXX31V5513nrXf4/Hoz3/+s2bOnKnBgwcrKSlJb7zxhjZt2qTNmzdLklavXq0vvvhCf/nLX3TFFVdo2LBheuKJJ/Tiiy+qrq5OklRQUKC4uDjNmDFDCQkJmjhxou644w7NmjUrIOcLAABan4AHUXp6ulJTU5WcnOy3v7S0VPX19X77e/furZ49e6qkpESSVFJSoj59+sjpdFpzUlJS5PV6tXPnTmvOPx87JSXFOsap1NbWyuv1+m0AAKD9Cgnki7/11lv67LPPtHXr1kZjbrdboaGhioiI8NvvdDrldrutOSfH0InxE2M/Ncfr9erIkSMKCwtr9Nr5+fmaOnVqk88LAAC0LQG7QlRZWak//vGPWrhwoTp16hSoZZxSbm6uPB6PtVVWVgZ6SQAAoBkFLIhKS0tVXV2t/v37KyQkRCEhISouLtacOXMUEhIip9Opuro61dTU+D2vqqpK0dHRkqTo6OhGnzo78fjn5tjt9lNeHZIkm80mu93utwEAgPYrYEF00003afv27SorK7O2q666SqNGjbL+3bFjR61du9Z6Tnl5uSoqKuRyuSRJLpdL27dvV3V1tTVnzZo1stvtSkxMtOacfIwTc04cAwAAIGD3EHXt2lWXX365374uXbqoe/fu1v6xY8cqKytL3bp1k91u16RJk+RyuTRw4EBJ0pAhQ5SYmKi7775bzz77rNxutx599FGlp6fLZrNJksaPH68XXnhB2dnZuu+++7Ru3TotWbJERUVFLXvCAACg1QroTdU/Z9asWQoODlZaWppqa2uVkpKil156yRrv0KGDli9frgkTJsjlcqlLly4aM2aMpk2bZs2Ji4tTUVGRMjMzNXv2bPXo0UOvvfaaUlJSAnFKAACgFQry+Xy+QC+itfN6vXI4HPJ4PM16P1HS5AXNdmygLSt9bnSgl3DWKqb1CfQSgFapZ972Zjv2mfz+Dvj3EAEAAAQaQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4TQqiwYMHq6amptF+r9erwYMHn+2aAAAAWlSTgmj9+vWqq6trtP/o0aP6+OOPz3pRAAAALSnkTCZ//vnn1r+/+OILud1u6/Hx48e1cuVKXXjhhedudQAAAC3gjILoiiuuUFBQkIKCgk751lhYWJjmzp17zhYHAADQEs4oiPbs2SOfz6eLLrpIn3zyiSIjI62x0NBQRUVFqUOHDud8kQAAAM3pjIKoV69ekqSGhoZmWQwAAEAgnFEQnWz37t368MMPVV1d3SiQ8vLyznphAAAALaVJQfTqq69qwoQJOv/88xUdHa2goCBrLCgoiCACAABtSpOC6Mknn9T06dOVk5NzrtcDAADQ4pr0PUQ//PCD7rzzznO9FgAAgIBoUhDdeeedWr169bleCwAAQEA06S2z+Ph4PfbYY9q8ebP69Omjjh07+o0/9NBD52RxAAAALaFJQfTKK68oPDxcxcXFKi4u9hsLCgoiiAAAQJvSpCDas2fPuV4HAABAwDTpHiIAAID2pElBdN999/3kdrrmzZunvn37ym63y263y+VyacWKFdb40aNHlZ6eru7duys8PFxpaWmqqqryO0ZFRYVSU1PVuXNnRUVFafLkyTp27JjfnPXr16t///6y2WyKj49XYWFhU04bAAC0U03+2P3JW3V1tdatW6e//vWvqqmpOe3j9OjRQ08//bRKS0v16aefavDgwfrNb36jnTt3SpIyMzO1bNkyvf322youLtbevXt1++23W88/fvy4UlNTVVdXp02bNmn+/PkqLCz0+2LIPXv2KDU1VYMGDVJZWZkyMjJ0//33a9WqVU05dQAA0A4F+Xw+37k4UENDgyZMmKBf/vKXys7ObvJxunXrpueee0533HGHIiMjtWjRIt1xxx2SpF27dikhIUElJSUaOHCgVqxYoeHDh2vv3r1yOp2SpIKCAuXk5Gjfvn0KDQ1VTk6OioqKtGPHDus1RowYoZqaGq1cufKUa6itrVVtba312Ov1KjY2Vh6PR3a7vcnn9nOSJi9otmMDbVnpc6MDvYSzVjGtT6CXALRKPfO2N9uxvV6vHA7Haf3+Pmf3EAUHBysrK0uzZs1q0vOPHz+ut956S4cOHZLL5VJpaanq6+uVnJxszendu7d69uypkpISSVJJSYn69OljxZAkpaSkyOv1WleZSkpK/I5xYs6JY5xKfn6+HA6HtcXGxjbpnAAAQNtwTm+q/vrrrxvdv/Nztm/frvDwcNlsNo0fP17vvvuuEhMT5Xa7FRoaqoiICL/5TqdTbrdbkuR2u/1i6MT4ibGfmuP1enXkyJFTrik3N1cej8faKisrz+icAABA29Kkj91nZWX5Pfb5fPruu+9UVFSkMWPGnNGxLr30UpWVlcnj8eidd97RmDFjGn23UUuz2Wyy2WwBXQMAAGg5TQqi//mf//F7HBwcrMjISM2YMeOMPmUmSaGhoYqPj5ckJSUlaevWrZo9e7Z+97vfqa6uTjU1NX5XiaqqqhQdHS1Jio6O1ieffOJ3vBOfQjt5zj9/Mq2qqkp2u11hYWFntFYAANA+NSmIPvzww3O9DktDQ4Nqa2uVlJSkjh07au3atUpLS5MklZeXq6KiQi6XS5Lkcrk0ffp0VVdXKyoqSpK0Zs0a2e12JSYmWnP++7//2+811qxZYx0DAACgSUF0wr59+1ReXi7px7e+IiMjz+j5ubm5GjZsmHr27KkDBw5o0aJFWr9+vVatWiWHw6GxY8cqKytL3bp1k91u16RJk+RyuTRw4EBJ0pAhQ5SYmKi7775bzz77rNxutx599FGlp6dbb3mNHz9eL7zwgrKzs3Xfffdp3bp1WrJkiYqKis7m1AEAQDvSpCA6dOiQJk2apAULFqihoUGS1KFDB40ePVpz585V586dT+s41dXVGj16tL777js5HA717dtXq1at0s033yxJmjVrloKDg5WWlqba2lqlpKTopZdesp7foUMHLV++XBMmTJDL5VKXLl00ZswYTZs2zZoTFxenoqIiZWZmavbs2erRo4dee+01paSkNOXUAQBAO9Sk7yH6wx/+oA8++EAvvPCCrr32WknShg0b9NBDD+nmm2/WvHnzzvlCA+lMvsfgbPA9RMCp8T1EQPvVWr6HqElXiP7rv/5L77zzjm688UZr3y233KKwsDD99re/bXdBBAAA2rcmfQ/R4cOHG323jyRFRUXp8OHDZ70oAACAltSkIHK5XJoyZYqOHj1q7Tty5IimTp3Kp7cAAECb06S3zJ5//nkNHTpUPXr0UL9+/SRJ27Ztk81m0+rVq8/pAgEAAJpbk4KoT58+2r17txYuXKhdu3ZJkkaOHKlRo0bxZYcAAKDNaVIQ5efny+l0aty4cX77X3/9de3bt085OTnnZHEAAAAtoUn3EL388svq3bt3o/2XXXaZCgoKznpRAAAALalJQeR2u3XBBRc02h8ZGanvvvvurBcFAADQkpoURLGxsdq4cWOj/Rs3blRMTMxZLwoAAKAlNekeonHjxikjI0P19fUaPHiwJGnt2rXKzs7Wn/70p3O6QAAAgObWpCCaPHmyvv/+ez344IOqq6uTJHXq1Ek5OTnKzc09pwsEAABobk0KoqCgID3zzDN67LHH9OWXXyosLEwXX3yx9RfmAQAA2pImBdEJ4eHhuvrqq8/VWgAAAAKiSTdVAwAAtCcEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgBDaL8/HxdffXV6tq1q6KionTrrbeqvLzcb87Ro0eVnp6u7t27Kzw8XGlpaaqqqvKbU1FRodTUVHXu3FlRUVGaPHmyjh075jdn/fr16t+/v2w2m+Lj41VYWNjcpwcAANqIgAZRcXGx0tPTtXnzZq1Zs0b19fUaMmSIDh06ZM3JzMzUsmXL9Pbbb6u4uFh79+7V7bffbo0fP35cqampqqur06ZNmzR//nwVFhYqLy/PmrNnzx6lpqZq0KBBKisrU0ZGhu6//36tWrWqRc8XAAC0TkE+n88X6EWcsG/fPkVFRam4uFg33HCDPB6PIiMjtWjRIt1xxx2SpF27dikhIUElJSUaOHCgVqxYoeHDh2vv3r1yOp2SpIKCAuXk5Gjfvn0KDQ1VTk6OioqKtGPHDuu1RowYoZqaGq1cubLROmpra1VbW2s99nq9io2Nlcfjkd1ub7bzT5q8oNmODbRlpc+NDvQSzlrFtD6BXgLQKvXM295sx/Z6vXI4HKf1+7tV3UPk8XgkSd26dZMklZaWqr6+XsnJydac3r17q2fPniopKZEklZSUqE+fPlYMSVJKSoq8Xq927txpzTn5GCfmnDjGP8vPz5fD4bC22NjYc3eSAACg1Wk1QdTQ0KCMjAxde+21uvzyyyVJbrdboaGhioiI8JvrdDrldrutOSfH0InxE2M/Ncfr9erIkSON1pKbmyuPx2NtlZWV5+QcAQBA6xQS6AWckJ6erh07dmjDhg2BXopsNptsNluglwEAAFpIq7hCNHHiRC1fvlwffvihevToYe2Pjo5WXV2dampq/OZXVVUpOjramvPPnzo78fjn5tjtdoWFhZ3r0wEAAG1MQIPI5/Np4sSJevfdd7Vu3TrFxcX5jSclJaljx45au3atta+8vFwVFRVyuVySJJfLpe3bt6u6utqas2bNGtntdiUmJlpzTj7GiTknjgEAAMwW0LfM0tPTtWjRIr333nvq2rWrdc+Pw+FQWFiYHA6Hxo4dq6ysLHXr1k12u12TJk2Sy+XSwIEDJUlDhgxRYmKi7r77bj377LNyu9169NFHlZ6ebr3tNX78eL3wwgvKzs7Wfffdp3Xr1mnJkiUqKioK2LkDAIDWI6BXiObNmyePx6Mbb7xRF1xwgbUtXrzYmjNr1iwNHz5caWlpuuGGGxQdHa2//vWv1niHDh20fPlydejQQS6XS7///e81evRoTZs2zZoTFxenoqIirVmzRv369dOMGTP02muvKSUlpUXPFwAAtE6t6nuIWqsz+R6Ds8H3EAGnxvcQAe0X30MEAADQShBEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAENoo8++ki//vWvFRMTo6CgIC1dutRv3OfzKS8vTxdccIHCwsKUnJys3bt3+83Zv3+/Ro0aJbvdroiICI0dO1YHDx70m/P555/r+uuvV6dOnRQbG6tnn322uU8NAAC0IQENokOHDqlfv3568cUXTzn+7LPPas6cOSooKNCWLVvUpUsXpaSk6OjRo9acUaNGaefOnVqzZo2WL1+ujz76SA888IA17vV6NWTIEPXq1UulpaV67rnn9Pjjj+uVV15p9vMDAABtQ0ggX3zYsGEaNmzYKcd8Pp+ef/55Pfroo/rNb34jSVqwYIGcTqeWLl2qESNG6Msvv9TKlSu1detWXXXVVZKkuXPn6pZbbtF//Md/KCYmRgsXLlRdXZ1ef/11hYaG6rLLLlNZWZlmzpzpF04AAMBcrfYeoj179sjtdis5Odna53A4NGDAAJWUlEiSSkpKFBERYcWQJCUnJys4OFhbtmyx5txwww0KDQ215qSkpKi8vFw//PDDKV+7trZWXq/XbwMAAO1Xqw0it9stSXI6nX77nU6nNeZ2uxUVFeU3HhISom7duvnNOdUxTn6Nf5afny+Hw2FtsbGxZ39CAACg1Wq1QRRIubm58ng81lZZWRnoJQEAgGbUaoMoOjpaklRVVeW3v6qqyhqLjo5WdXW13/ixY8e0f/9+vzmnOsbJr/HPbDab7Ha73wYAANqvVhtEcXFxio6O1tq1a619Xq9XW7ZskcvlkiS5XC7V1NSotLTUmrNu3To1NDRowIAB1pyPPvpI9fX11pw1a9bo0ksv1XnnnddCZwMAAFqzgAbRwYMHVVZWprKyMkk/3khdVlamiooKBQUFKSMjQ08++aTef/99bd++XaNHj1ZMTIxuvfVWSVJCQoKGDh2qcePG6ZNPPtHGjRs1ceJEjRgxQjExMZKku+66S6GhoRo7dqx27typxYsXa/bs2crKygrQWQMAgNYmoB+7//TTTzVo0CDr8YlIGTNmjAoLC5Wdna1Dhw7pgQceUE1Nja677jqtXLlSnTp1sp6zcOFCTZw4UTfddJOCg4OVlpamOXPmWOMOh0OrV69Wenq6kpKSdP755ysvL4+P3AMAAEuQz+fzBXoRrZ3X65XD4ZDH42nW+4mSJi9otmMDbVnpc6MDvYSzVjGtT6CXALRKPfO2N9uxz+T3d6u9hwgAAKClEEQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHgEEQAAMB5BBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4RgXRiy++qF/84hfq1KmTBgwYoE8++STQSwIAAK2AMUG0ePFiZWVlacqUKfrss8/Ur18/paSkqLq6OtBLAwAAAWZMEM2cOVPjxo3Tvffeq8TERBUUFKhz5856/fXXA700AAAQYCGBXkBLqKurU2lpqXJzc619wcHBSk5OVklJSaP5tbW1qq2ttR57PB5JktfrbdZ1Hq890qzHB9qq5v7ZawkHjh4P9BKAVqk5f75PHNvn8/3sXCOC6B//+IeOHz8up9Ppt9/pdGrXrl2N5ufn52vq1KmN9sfGxjbbGgH8a4654wO9BADNJd/R7C9x4MABORw//TpGBNGZys3NVVZWlvW4oaFB+/fvV/fu3RUUFBTAlaEleL1excbGqrKyUna7PdDLAXAO8fNtFp/PpwMHDigmJuZn5xoRROeff746dOigqqoqv/1VVVWKjo5uNN9ms8lms/nti4iIaM4lohWy2+38DxNop/j5NsfPXRk6wYibqkNDQ5WUlKS1a9da+xoaGrR27Vq5XK4ArgwAALQGRlwhkqSsrCyNGTNGV111la655ho9//zzOnTokO69995ALw0AAASYMUH0u9/9Tvv27VNeXp7cbreuuOIKrVy5stGN1oDNZtOUKVMavW0KoO3j5xv/SpDvdD6LBgAA0I4ZcQ8RAADATyGIAACA8QgiAABgPIIIOElhYSHfOQUABiKI0C7dc889CgoKarR99dVXgV4agHPkVD/jJ2+PP/54oJeINsSYj93DPEOHDtUbb7zhty8yMjJAqwFwrn333XfWvxcvXqy8vDyVl5db+8LDw61/+3w+HT9+XCEh/NrDqXGFCO2WzWZTdHS03zZ79mz16dNHXbp0UWxsrB588EEdPHjwXx5j27ZtGjRokLp27Sq73a6kpCR9+umn1viGDRt0/fXXKywsTLGxsXrooYd06NChljg9wHgn/2w7HA4FBQVZj3ft2qWuXbtqxYoVSkpKks1m04YNG3TPPffo1ltv9TtORkaGbrzxRutxQ0OD8vPzFRcXp7CwMPXr10/vvPNOy54cWhxBBKMEBwdrzpw52rlzp+bPn69169YpOzv7X84fNWqUevTooa1bt6q0tFSPPPKIOnbsKEn6+uuvNXToUKWlpenzzz/X4sWLtWHDBk2cOLGlTgfAz3jkkUf09NNP68svv1Tfvn1P6zn5+flasGCBCgoKtHPnTmVmZur3v/+9iouLm3m1CCSuHaLdWr58ud8l82HDhuntt9+2Hv/iF7/Qk08+qfHjx+ull1465TEqKio0efJk9e7dW5J08cUXW2P5+fkaNWqUMjIyrLE5c+boV7/6lebNm6dOnTo1w1kBOBPTpk3TzTfffNrza2tr9dRTT+mDDz6w/tblRRddpA0bNujll1/Wr371q+ZaKgKMIEK7NWjQIM2bN8963KVLF33wwQfKz8/Xrl275PV6dezYMR09elSHDx9W586dGx0jKytL999/v958800lJyfrzjvv1C9/+UtJP76d9vnnn2vhwoXWfJ/Pp4aGBu3Zs0cJCQnNf5IAftJVV111RvO/+uorHT58uFFE1dXV6corrzyXS0MrQxCh3erSpYvi4+Otx99++62GDx+uCRMmaPr06erWrZs2bNigsWPHqq6u7pRB9Pjjj+uuu+5SUVGRVqxYoSlTpuitt97SbbfdpoMHD+oPf/iDHnrooUbP69mzZ7OeG4DT06VLF7/HwcHB+ue/WFVfX2/9+8Q9hUVFRbrwwgv95vH3z9o3ggjGKC0tVUNDg2bMmKHg4B9vn1uyZMnPPu+SSy7RJZdcoszMTI0cOVJvvPGGbrvtNvXv319ffPGFX3QBaN0iIyO1Y8cOv31lZWXWvYGJiYmy2WyqqKjg7THDcFM1jBEfH6/6+nrNnTtX33zzjd58800VFBT8y/lHjhzRxIkTtX79ev3v//6vNm7cqK1bt1pvheXk5GjTpk2aOHGiysrKtHv3br333nvcVA20YoMHD9ann36qBQsWaPfu3ZoyZYpfIHXt2lUPP/ywMjMzNX/+fH399df67LPPNHfuXM2fPz+AK0dzI4hgjH79+mnmzJl65plndPnll2vhwoXKz8//l/M7dOig77//XqNHj9Yll1yi3/72txo2bJimTp0qSerbt6+Ki4v1t7/9Tddff72uvPJK5eXlKSYmpqVOCcAZSklJ0WOPPabs7GxdffXVOnDggEaPHu0354knntBjjz2m/Px8JSQkaOjQoSoqKlJcXFyAVo2WEOT75zdTAQAADMMVIgAAYDyCCAAAGI8gAgAAxiOIAACA8QgiAABgPIIIAAAYjyACAADGI4gAAIDxCCIAxiosLFRERMRZHycoKEhLly496+MACByCCECbds899+jWW28N9DIAtHEEEQAAMB5BBKDdmjlzpvr06aMuXbooNjZWDz74oA4ePNho3tKlS3XxxRerU6dOSklJUWVlpd/4e++9p/79+6tTp0666KKLNHXqVB07dqylTgNACyCIALRbwcHBmjNnjnbu3Kn58+dr3bp1ys7O9ptz+PBhTZ8+XQsWLNDGjRtVU1OjESNGWOMff/yxRo8erT/+8Y/64osv9PLLL6uwsFDTp09v6dMB0Iz4a/cA2rR77rlHNTU1p3VT8zvvvKPx48frH//4h6Qfb6q+9957tXnzZg0YMECStGvXLiUkJGjLli265pprlJycrJtuukm5ubnWcf7yl78oOztbe/fulfTjTdXvvvsu9zIBbVhIoBcAAM3lgw8+UH5+vnbt2iWv16tjx47p6NGjOnz4sDp37ixJCgkJ0dVXX209p3fv3oqIiNCXX36pa665Rtu2bdPGjRv9rggdP3680XEAtG0EEYB26dtvv9Xw4cM1YcIETZ8+Xd26ddOGDRs0duxY1dXVnXbIHDx4UFOnTtXtt9/eaKxTp07netkAAoQgAtAulZaWqqGhQTNmzFBw8I+3Sy5ZsqTRvGPHjunTTz/VNddcI0kqLy9XTU2NEhISJEn9+/dXeXm54uPjW27xAFocQQSgzfN4PCorK/Pbd/7556u+vl5z587Vr3/9a23cuFEFBQWNntuxY0dNmjRJc+bMUUhIiCZOnKiBAwdagZSXl6fhw4erZ8+euuOOOxQcHKxt27Zpx44devLJJ1vi9AC0AD5lBqDNW79+va688kq/7c0339TMmTP1zDPP6PLLL9fChQuVn5/f6LmdO3dWTk6O7rrrLl177bUKDw/X4sWLrfGUlBQtX75cq1ev1tVXX62BAwdq1qxZ6tWrV0ueIoBmxqfMAACA8bhCBAAAjEcQAQAA4xFEAADAeAQRAAAwHkEEAACMRxABAADjEUQAAMB4BBEAADAeQQQAAIxHEAEAAOMRRAAAwHj/D/3hVIUbnzzWAAAAAElFTkSuQmCC\n","text/plain":["<Figure size 640x480 with 1 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["\n","import pandas as pd\n","import csv\n","import numpy as np\n","import nltk\n","import seaborn as sb\n","\n","\n","#data observation\n","def data_obs():\n","    print(\"training dataset size:\")\n","    print(train_news.shape)\n","    print(train_news.head(10))\n","\n","    #below dataset were used for testing and validation purposes\n","    print(test_news.shape)\n","    print(test_news.head(10))\n","\n","    print(valid_news.shape)\n","    print(valid_news.head(10))\n","\n","#check the data by calling below function\n","data_obs()\n","\n","#distribution of classes for prediction\n","def create_distribution(dataFile):\n","    return sb.countplot(x='Label', data=dataFile)\n","\n","\n","#by calling below we can see that training, test and valid data seems to be failry evenly distributed between the classes\n","create_distribution(train_news)\n","create_distribution(test_news)\n","\n","\n","\n","#data integrity check (missing label values)\n","#none of the datasets contains missing values therefore no cleaning required\n","def data_qualityCheck():\n","\n","    print(\"Checking data qualitites...\")\n","    train_news.isnull().sum()\n","    train_news.info()\n","\n","    print(\"check finished.\")\n","\n","    #below datasets were used to\n","    test_news.isnull().sum()\n","    test_news.info()\n","\n","    valid_news.isnull().sum()\n","    valid_news.info()\n","\n","#run the below function call to see the quality check results\n","data_qualityCheck()\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1129,"status":"ok","timestamp":1688924583829,"user":{"displayName":"Alok Kumar","userId":"15647139801406588119"},"user_tz":-330},"id":"-n2TTllAv87K","outputId":"028065be-b732-4e65-ac47-43647cbe460f"},"outputs":[{"name":"stderr","output_type":"stream","text":["[nltk_data] Downloading package treebank to /root/nltk_data...\n","[nltk_data]   Unzipping corpora/treebank.zip.\n"]},{"data":{"text/plain":["True"]},"execution_count":18,"metadata":{},"output_type":"execute_result"}],"source":["import nltk\n","nltk.download('treebank')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":17218,"status":"ok","timestamp":1688952610886,"user":{"displayName":"Alok Kumar","userId":"15647139801406588119"},"user_tz":-330},"id":"-dB10JmcmLMc","outputId":"ed2d67ef-ff2a-44d5-fc7d-e8eaf8cb3a72"},"outputs":[{"name":"stdout","output_type":"stream","text":["CountVectorizer()\n","  (0, 9676)\t1\n","  (0, 10988)\t1\n","  (0, 1044)\t1\n","  (0, 6639)\t1\n","  (0, 8376)\t1\n","  (0, 5115)\t1\n","  (0, 10709)\t1\n","  (0, 11036)\t1\n","  (0, 11296)\t1\n","  (0, 615)\t1\n","  (0, 7728)\t1\n","  (0, 3278)\t1\n","  (1, 10988)\t1\n","  (1, 11934)\t2\n","  (1, 3434)\t1\n","  (1, 3185)\t1\n","  (1, 7672)\t1\n","  (1, 2475)\t1\n","  (1, 10425)\t1\n","  (1, 6052)\t1\n","  (1, 10426)\t2\n","  (1, 7418)\t1\n","  (1, 4860)\t1\n","  (1, 11138)\t1\n","  (1, 7674)\t1\n","  :\t:\n","  (10239, 10988)\t1\n","  (10239, 7672)\t2\n","  (10239, 11110)\t2\n","  (10239, 5267)\t1\n","  (10239, 7828)\t1\n","  (10239, 7824)\t1\n","  (10239, 1159)\t1\n","  (10239, 12151)\t2\n","  (10239, 6327)\t1\n","  (10239, 6603)\t1\n","  (10239, 11013)\t1\n","  (10239, 11004)\t1\n","  (10239, 3309)\t1\n","  (10239, 12158)\t1\n","  (10239, 11660)\t2\n","  (10239, 799)\t1\n","  (10239, 2568)\t1\n","  (10239, 11622)\t1\n","  (10239, 2549)\t1\n","  (10239, 10660)\t1\n","  (10239, 8996)\t1\n","  (10239, 10918)\t1\n","  (10239, 3989)\t1\n","  (10239, 10594)\t1\n","  (10239, 6853)\t1\n","0        Says the Annies List political group supports ...\n","1        When did the decline of coal start? It started...\n","2        Hillary Clinton agrees with John McCain \"by vo...\n","3        Health care reform legislation is likely to ma...\n","4        The economic turnaround started at the end of ...\n","                               ...                        \n","10235    There are a larger number of shark attacks in ...\n","10236    Democrats have now become the party of the [At...\n","10237    Says an alternative to Social Security that op...\n","10238    On lifting the U.S. Cuban embargo and allowing...\n","10239    The Department of Veterans Affairs has a manua...\n","Name: Statement, Length: 10240, dtype: object\n"]},{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["\"\\nclass TfidfEmbeddingVectorizer(object):\\n    def __init__(self, word2vec):\\n        self.word2vec = word2vec\\n        self.word2weight = None\\n        self.dim = len(word2vec.itervalues().next())\\n\\n    def fit(self, X, y):\\n        tfidf = TfidfVectorizer(analyzer=lambda x: x)\\n        tfidf.fit(X)\\n        # if a word was never seen - it must be at least as infrequent\\n        # as any of the known words - so the default idf is the max of\\n        # known idf's\\n        max_idf = max(tfidf.idf_)\\n        self.word2weight = defaultdict(\\n            lambda: max_idf,\\n            [(w, tfidf.idf_[i]) for w, i in tfidf.vocabulary_.items()])\\n\\n        return self\\n\\n    def transform(self, X):\\n        return np.array([\\n                np.mean([self.word2vec[w] * self.word2weight[w]\\n                         for w in words if w in self.word2vec] or\\n                        [np.zeros(self.dim)], axis=0)\\n                for words in X\\n            ])\\n\\n\""]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["\n","import pandas as pd\n","import numpy as np\n","from sklearn.feature_extraction.text import CountVectorizer\n","from sklearn.feature_extraction.text import TfidfTransformer\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.pipeline import Pipeline\n","import nltk\n","import nltk.corpus\n","from nltk.tokenize import word_tokenize\n","from gensim.models.word2vec import Word2Vec\n","\n","\n","#we will start with simple bag of words technique\n","#creating feature vector - document term matrix\n","countV = CountVectorizer()\n","train_count = countV.fit_transform(train_news['Statement'].values)\n","\n","print(train_count)\n","\n","#create tf-df frequency features\n","#tf-idf\n","tfidfV = TfidfTransformer()\n","train_tfidf = tfidfV.fit_transform(train_count)\n","\n","tfidf_ngram = TfidfVectorizer(stop_words='english',ngram_range=(1,4),use_idf=True,smooth_idf=True)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":138209,"status":"ok","timestamp":1688952768768,"user":{"displayName":"Alok Kumar","userId":"15647139801406588119"},"user_tz":-330},"id":"xdC_-lKGvyaJ","outputId":"bcbdcaf8-e0ae-4c24-db76-ea8589a6616c"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n","/usr/local/lib/python3.10/dist-packages/sklearn/svm/_base.py:1244: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n","  warnings.warn(\n"]},{"name":"stdout","output_type":"stream","text":["Classifier:  Pipeline(steps=[('NBCV', CountVectorizer()), ('nb_clf', MultinomialNB())])\n","Score: 0.66961153965076\n","score length 5\n","Confusion matrix:\n","[[2118 2370]\n"," [1664 4088]]\n","Total statements classified: 10240 None None None None\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n","/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n","/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n","/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n","/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n"]},{"name":"stdout","output_type":"stream","text":["Classifier:  Pipeline(steps=[('LogRCV', CountVectorizer()),\n","                ('LogR_clf', LogisticRegression())])\n","Score: 0.6466692934443682\n","score length 5\n","Confusion matrix:\n","[[2254 2234]\n"," [1936 3816]]\n","Total statements classified: 10240 None None None None\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.10/dist-packages/sklearn/svm/_base.py:1244: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n","  warnings.warn(\n"]},{"name":"stdout","output_type":"stream","text":["Classifier:  Pipeline(steps=[('svmCV', CountVectorizer()), ('svm_clf', LinearSVC())])\n","Score: 0.6104687487924283\n","score length 5\n","Confusion matrix:\n","[[2260 2228]\n"," [2246 3506]]\n","Total statements classified: 10240 None None None None\n","Classifier:  Pipeline(steps=[('rfCV', CountVectorizer()),\n","                ('rf_clf', RandomForestClassifier(n_estimators=200, n_jobs=3))])\n","Score: 0.7011609739851915\n","score length 5\n","Confusion matrix:\n","[[1792 2696]\n"," [1191 4561]]\n","Total statements classified: 10240 None None None None\n"]}],"source":["\n","import numpy as np\n","import pandas as pd\n","import pickle\n","from sklearn.feature_extraction.text import CountVectorizer\n","from sklearn.feature_extraction.text import TfidfTransformer\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.pipeline import Pipeline\n","from sklearn.naive_bayes import MultinomialNB\n","from sklearn.linear_model import  LogisticRegression\n","from sklearn import svm\n","from sklearn.ensemble import RandomForestClassifier\n","from sklearn.model_selection import KFold\n","from sklearn.metrics import confusion_matrix, f1_score, classification_report\n","from sklearn.model_selection import GridSearchCV\n","from sklearn.model_selection import learning_curve\n","import matplotlib.pyplot as plt\n","from sklearn.metrics import precision_recall_curve\n","from sklearn.metrics import average_precision_score\n","\n","\n","#first we will use bag of words techniques\n","\n","#building classifier using naive bayes\n","nb_pipeline = Pipeline([\n","        ('NBCV',countV),\n","        ('nb_clf',MultinomialNB())])\n","\n","nb_pipeline.fit(train_news['Statement'],train_news['Label'])\n","predicted_nb = nb_pipeline.predict(test_news['Statement'])\n","np.mean(predicted_nb == test_news['Label'])\n","\n","\n","#building classifier using logistic regression\n","logR_pipeline = Pipeline([\n","        ('LogRCV',countV),\n","        ('LogR_clf',LogisticRegression())\n","        ])\n","\n","logR_pipeline.fit(train_news['Statement'],train_news['Label'])\n","predicted_LogR = logR_pipeline.predict(test_news['Statement'])\n","np.mean(predicted_LogR == test_news['Label'])\n","\n","\n","#building Linear SVM classfier\n","svm_pipeline = Pipeline([\n","        ('svmCV',countV),\n","        ('svm_clf',svm.LinearSVC())\n","        ])\n","\n","svm_pipeline.fit(train_news['Statement'],train_news['Label'])\n","predicted_svm = svm_pipeline.predict(test_news['Statement'])\n","np.mean(predicted_svm == test_news['Label'])\n","\n","\n","\n","#random forest\n","random_forest = Pipeline([\n","        ('rfCV',countV),\n","        ('rf_clf',RandomForestClassifier(n_estimators=200,n_jobs=3))\n","        ])\n","\n","random_forest.fit(train_news['Statement'],train_news['Label'])\n","predicted_rf = random_forest.predict(test_news['Statement'])\n","np.mean(predicted_rf == test_news['Label'])\n","\n","\n","#User defined functon for K-Fold cross validatoin\n","def build_confusion_matrix(classifier):\n","\n","    k_fold = KFold(n_splits=5)\n","    scores = []\n","    confusion = np.array([[0,0],[0,0]])\n","\n","    for train_ind, test_ind in k_fold.split(train_news):\n","        train_text = train_news.iloc[train_ind]['Statement']\n","        train_y = train_news.iloc[train_ind]['Label']\n","\n","        test_text = train_news.iloc[test_ind]['Statement']\n","        test_y = train_news.iloc[test_ind]['Label']\n","\n","        classifier.fit(train_text,train_y)\n","        predictions = classifier.predict(test_text)\n","\n","        confusion += confusion_matrix(test_y,predictions)\n","        score = f1_score(test_y,predictions)\n","        scores.append(score)\n","    print(\"Classifier: \",classifier)\n","    print('Total statements classified:', len(train_news),\n","    print('Score:', sum(scores)/len(scores)),\n","    print('score length', len(scores)),\n","    print('Confusion matrix:'),\n","    print(confusion))\n","\n","#K-fold cross validation for all classifiers\n","build_confusion_matrix(nb_pipeline)\n","build_confusion_matrix(logR_pipeline)\n","build_confusion_matrix(svm_pipeline)\n","build_confusion_matrix(random_forest)\n"]},{"cell_type":"code","source":["#========================================================================================\n","#Bag of words confusion matrix and F1 scores\n","\n","#Naive bayes\n","# [2118 2370]\n","# [1664 4088]\n","# f1-Score: 0.669611539651\n","\n","#Logistic regression\n","# [2252 2236]\n","# [1933 3819]\n","# f1-Score: 0.646909097798\n","\n","#svm\n","# [2260 2228]\n","# [2246 3506]\n","#f1-score: 0.610468748792\n","\n","\n","#random forest classifier\n","# [1821 2667]\n","# [1192 4560]\n","# f1-Score: 0.702651511011\n","#========================================================================================="],"metadata":{"id":"tvc0PJVWWamE"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1458115,"status":"ok","timestamp":1688954364004,"user":{"displayName":"Alok Kumar","userId":"15647139801406588119"},"user_tz":-330},"id":"U6i986yPLCUJ","outputId":"b3e04f64-7b33-4b81-9a3e-d5e8ada887ca"},"outputs":[{"name":"stdout","output_type":"stream","text":["Classifier:  Pipeline(steps=[('nb_tfidf',\n","                 TfidfVectorizer(ngram_range=(1, 4), stop_words='english')),\n","                ('nb_clf', MultinomialNB())])\n","Score: 0.7224053159841455\n","score length 5\n","Confusion matrix:\n","[[ 758 3730]\n"," [ 390 5362]]\n","Total statements classified: 10240 None None None None\n","Classifier:  Pipeline(steps=[('LogR_tfidf',\n","                 TfidfVectorizer(ngram_range=(1, 4), stop_words='english')),\n","                ('LogR_clf', LogisticRegression(C=1))])\n","Score: 0.7044355553757985\n","score length 5\n","Confusion matrix:\n","[[1580 2908]\n"," [1043 4709]]\n","Total statements classified: 10240 None None None None\n","Classifier:  Pipeline(steps=[('svm_tfidf',\n","                 TfidfVectorizer(ngram_range=(1, 4), stop_words='english')),\n","                ('svm_clf', LinearSVC())])\n","Score: 0.6790920142902143\n","score length 5\n","Confusion matrix:\n","[[2016 2472]\n"," [1524 4228]]\n","Total statements classified: 10240 None None None None\n","Classifier:  Pipeline(steps=[('rf_tfidf',\n","                 TfidfVectorizer(ngram_range=(1, 4), stop_words='english')),\n","                ('rf_clf', RandomForestClassifier(n_estimators=300, n_jobs=3))])\n","Score: 0.6597434473250703\n","score length 5\n","Confusion matrix:\n","[[1975 2513]\n"," [1683 4069]]\n","Total statements classified: 10240 None None None None\n"]}],"source":["\n","\"\"\"So far we have used bag of words technique to extract the features and passed those featuers into classifiers. We have also seen the\n","f1 scores of these classifiers. now lets enhance these features using term frequency weights with various n-grams\n","\"\"\"\n","\n","##Now using n-grams\n","#naive-bayes classifier\n","nb_pipeline_ngram = Pipeline([\n","        ('nb_tfidf',tfidf_ngram),\n","        ('nb_clf',MultinomialNB())])\n","\n","nb_pipeline_ngram.fit(train_news['Statement'],train_news['Label'])\n","predicted_nb_ngram = nb_pipeline_ngram.predict(test_news['Statement'])\n","np.mean(predicted_nb_ngram == test_news['Label'])\n","\n","\n","#logistic regression classifier\n","logR_pipeline_ngram = Pipeline([\n","        ('LogR_tfidf',tfidf_ngram),\n","        ('LogR_clf',LogisticRegression(penalty=\"l2\",C=1))\n","        ])\n","\n","logR_pipeline_ngram.fit(train_news['Statement'],train_news['Label'])\n","predicted_LogR_ngram = logR_pipeline_ngram.predict(test_news['Statement'])\n","np.mean(predicted_LogR_ngram == test_news['Label'])\n","\n","\n","#linear SVM classifier\n","svm_pipeline_ngram = Pipeline([\n","        ('svm_tfidf',tfidf_ngram),\n","        ('svm_clf',svm.LinearSVC())\n","        ])\n","\n","svm_pipeline_ngram.fit(train_news['Statement'],train_news['Label'])\n","predicted_svm_ngram = svm_pipeline_ngram.predict(test_news['Statement'])\n","np.mean(predicted_svm_ngram == test_news['Label'])\n","\n","\n","\n","#random forest classifier\n","random_forest_ngram = Pipeline([\n","        ('rf_tfidf',tfidf_ngram),\n","        ('rf_clf',RandomForestClassifier(n_estimators=300,n_jobs=3))\n","        ])\n","\n","random_forest_ngram.fit(train_news['Statement'],train_news['Label'])\n","predicted_rf_ngram = random_forest_ngram.predict(test_news['Statement'])\n","np.mean(predicted_rf_ngram == test_news['Label'])\n","\n","\n","#K-fold cross validation for all classifiers\n","build_confusion_matrix(nb_pipeline_ngram)\n","build_confusion_matrix(logR_pipeline_ngram)\n","build_confusion_matrix(svm_pipeline_ngram)\n","build_confusion_matrix(random_forest_ngram)"]},{"cell_type":"code","source":["#========================================================================================\n","#n-grams & tfidf confusion matrix and F1 scores\n","\n","#Naive bayes\n","# [841 3647]\n","# [427 5325]\n","# f1-Score: 0.723262051071\n","\n","#Logistic regression\n","# [1617 2871]\n","# [1097 4655]\n","# f1-Score: 0.70113000531\n","\n","#svm\n","# [2016 2472]\n","# [1524 4228]\n","# f1-Score: 0.67909201429\n","\n","#sgdclassifier\n","# [  10 4478]\n","# [  13 5739]\n","# f1-Score: 0.718731637053\n","\n","#random forest\n","# [1979 2509]\n","# [1630 4122]\n","# f1-Score: 0.665720333284\n","#========================================================================================="],"metadata":{"id":"opGyrp8cWYdw"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kLFMkc5zZgu4","outputId":"8599bb1f-50c7-4e94-f2de-678029421b90"},"outputs":[{"name":"stdout","output_type":"stream","text":["================================Naive Bayes========================================\n","              precision    recall  f1-score   support\n","\n","       False       0.72      0.19      0.30      1169\n","        True       0.58      0.94      0.71      1382\n","\n","    accuracy                           0.59      2551\n","   macro avg       0.65      0.56      0.51      2551\n","weighted avg       0.64      0.59      0.52      2551\n","\n","================================Logistic regression================================\n","              precision    recall  f1-score   support\n","\n","       False       0.64      0.39      0.49      1169\n","        True       0.61      0.81      0.70      1382\n","\n","    accuracy                           0.62      2551\n","   macro avg       0.62      0.60      0.59      2551\n","weighted avg       0.62      0.62      0.60      2551\n","\n","================================SVM================================================\n","              precision    recall  f1-score   support\n","\n","       False       0.61      0.47      0.53      1169\n","        True       0.62      0.74      0.68      1382\n","\n","    accuracy                           0.62      2551\n","   macro avg       0.61      0.61      0.60      2551\n","weighted avg       0.62      0.62      0.61      2551\n","\n","================================Random Forest======================================\n","              precision    recall  f1-score   support\n","\n","       False       0.58      0.48      0.53      1169\n","        True       0.62      0.71      0.66      1382\n","\n","    accuracy                           0.60      2551\n","   macro avg       0.60      0.59      0.59      2551\n","weighted avg       0.60      0.60      0.60      2551\n","\n"]}],"source":["\n","print(\"================================Naive Bayes========================================\")\n","print(classification_report(test_news['Label'], predicted_nb_ngram))\n","print(\"================================Logistic regression================================\")\n","print(classification_report(test_news['Label'], predicted_LogR_ngram))\n","print(\"================================SVM================================================\")\n","print(classification_report(test_news['Label'], predicted_svm_ngram))\n","print(\"================================Random Forest======================================\")\n","print(classification_report(test_news['Label'], predicted_rf_ngram))\n","\n","test_news['Label'].shape\n","\n","\"\"\"\n","Out of all the models fitted, we would take 2 best performing model. we would call them candidate models\n","from the confusion matrix, we can see that random forest and logistic regression are best performing\n","in terms of precision and recall (take a look into false positive and true negative counts which appeares\n","to be low compared to rest of the models)\n","\"\"\"\n","\n","#grid-search parameter optimization\n","#random forest classifier parameters\n","parameters = {'rf_tfidf__ngram_range': [(1, 1), (1, 2),(1,3),(1,4),(1,5)],\n","               'rf_tfidf__use_idf': (True, False),\n","               'rf_clf__max_depth': (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15)\n","}\n","\n","gs_clf = GridSearchCV(random_forest_ngram, parameters, n_jobs=-1)\n","gs_clf = gs_clf.fit(train_news['Statement'][:10000],train_news['Label'][:10000])\n","\n","gs_clf.best_score_\n","gs_clf.best_params_\n","gs_clf.cv_results_\n","\n","#logistic regression parameters\n","parameters = {'LogR_tfidf__ngram_range': [(1, 1), (1, 2),(1,3),(1,4),(1,5)],\n","               'LogR_tfidf__use_idf': (True, False),\n","               'LogR_tfidf__smooth_idf': (True, False)\n","}\n","\n","gs_clf = GridSearchCV(logR_pipeline_ngram, parameters, n_jobs=-1)\n","gs_clf = gs_clf.fit(train_news['Statement'][:10000],train_news['Label'][:10000])\n","\n","gs_clf.best_score_\n","gs_clf.best_params_\n","gs_clf.cv_results_\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21043,"status":"ok","timestamp":1688944326225,"user":{"displayName":"Alok Kumar","userId":"15647139801406588119"},"user_tz":-330},"id":"D_rKVT4svp99","outputId":"48e91cc3-2ad5-4ce5-ef83-3bf535f30c5e"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n","/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n","/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n","  _warn_prf(average, modifier, msg_start, len(result))\n"]},{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","       False       0.00      0.00      0.00      1169\n","        True       0.54      1.00      0.70      1382\n","\n","    accuracy                           0.54      2551\n","   macro avg       0.27      0.50      0.35      2551\n","weighted avg       0.29      0.54      0.38      2551\n","\n","              precision    recall  f1-score   support\n","\n","       False       0.64      0.38      0.48      1169\n","        True       0.61      0.82      0.70      1382\n","\n","    accuracy                           0.62      2551\n","   macro avg       0.62      0.60      0.59      2551\n","weighted avg       0.62      0.62      0.60      2551\n","\n"]}],"source":["#running both random forest and logistic regression models again with best parameter found with GridSearch method\n","\n","print(\"================================Random Forest======================================\")\n","random_forest_final = Pipeline([\n","        ('rf_tfidf',TfidfVectorizer(stop_words='english',ngram_range=(1,3),use_idf=True,smooth_idf=True)),\n","        ('rf_clf',RandomForestClassifier(n_estimators=300,n_jobs=3,max_depth=10))\n","        ])\n","\n","random_forest_final.fit(train_news['Statement'],train_news['Label'])\n","predicted_rf_final = random_forest_final.predict(test_news['Statement'])\n","np.mean(predicted_rf_final == test_news['Label'])\n","print(classification_report(test_news['Label'], predicted_rf_final))\n","\n","\n","print(\"================================Logistic regression================================\")\n","logR_pipeline_final = Pipeline([\n","        ('LogR_tfidf',TfidfVectorizer(stop_words='english',ngram_range=(1,5),use_idf=True,smooth_idf=False)),\n","        ('LogR_clf',LogisticRegression(penalty=\"l2\",C=1))\n","        ])\n","\n","logR_pipeline_final.fit(train_news['Statement'],train_news['Label'])\n","predicted_LogR_final = logR_pipeline_final.predict(test_news['Statement'])\n","np.mean(predicted_LogR_final == test_news['Label'])\n","#accuracy = 0.62\n","print(classification_report(test_news['Label'], predicted_LogR_final))"]},{"cell_type":"code","execution_count":13,"metadata":{"executionInfo":{"elapsed":524,"status":"ok","timestamp":1688966822709,"user":{"displayName":"Alok Kumar","userId":"15647139801406588119"},"user_tz":-330},"id":"l_jmlOdYOAjP"},"outputs":[],"source":["#saving best model to the disk\n","import pickle\n","model_file = '/content/drive/MyDrive/Colab_Notebooks/Fake_News_Detection/final_model.sav'\n","pickle.dump(logR_pipeline_ngram,open(model_file,'wb'))"]},{"cell_type":"code","source":["def detecting_fake_news(var):\n","#retrieving the best model for prediction call\n","    load_model = pickle.load(open('/content/drive/MyDrive/Colab_Notebooks/Fake_News_Detection/final_model.sav', 'rb'))\n","    prediction = load_model.predict([var])\n","# prob = load_model.predict_proba([var])\n","\n","    return (print(\"The given statement is \",prediction[0]))\n","# print(\"The truth probability score is \",prob[0][1]))"],"metadata":{"id":"eTEsdibPTnDN","executionInfo":{"status":"ok","timestamp":1688967723255,"user_tz":-330,"elapsed":464,"user":{"displayName":"Alok Kumar","userId":"15647139801406588119"}}},"execution_count":24,"outputs":[]},{"cell_type":"code","source":["data=pd.read_csv(\"/content/drive/MyDrive/Colab_Notebooks/Fake_News_Detection/valid.csv\")\n","\n","for i in range(50):\n","  detecting_fake_news(data[\"Statement\"][i])\n","  print(\"Actual Label: \",data[\"Label\"][i])\n","  print(\"\\n\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"chuAhKYHRjBV","executionInfo":{"status":"ok","timestamp":1688967737181,"user_tz":-330,"elapsed":9261,"user":{"displayName":"Alok Kumar","userId":"15647139801406588119"}},"outputId":"a7f00d2e-1e93-44c6-d897-37419775ea99"},"execution_count":25,"outputs":[{"output_type":"stream","name":"stdout","text":["The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  False\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  False\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  False\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  False\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  False\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  False\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  False\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  False\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  False\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  FALSE\n","\n","\n","The given statement is  False\n","Actual Label:  FALSE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n","The given statement is  True\n","Actual Label:  TRUE\n","\n","\n"]}]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyMwRodXx4iRRvHcs31zrdzh"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}